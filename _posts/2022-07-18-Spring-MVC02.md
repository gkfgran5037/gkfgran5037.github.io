---
title:  "Spring MVC 02 서블릿"
categories:
  - springMVC
---

### @ServletComponentScan
서블릿 자동 등록 어노테이션

```
@ServletComponentScan
@SpringBootApplication
public class ServletApplication {

	public static void main(String[] args) {
		SpringApplication.run(ServletApplication.class, args);
	}

}
```


### @WebServlet
서블릿 어노테이션  
* name: 서블릿 이름  
* urlPatterns: URL 매핑

```
@WebServlet(name = "helloServlet", urlPatterns = "/hello")
public class HelloServlet extends HttpServlet {
	@Override
	protected void service(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
	}
}
```



---

### HTTP 요청 메시지 로그 설정
서버가 받은 HTTP 요청 메시지를 출력
* 경로 : src\main\resources\application.properties 
```
logging.level.org.apache.coyote.http11=debug
```


### HttpServletRequest 역할
* HTTP 요청 메시지를 파싱한다.
* 요청 결과를 HttpServletRequest 객체에 담아서 제공한다.
* 해당 HTTP 요청이 시작부터 끝날 때 까지 유지되는 임시 저장소 기능
	* 저장: request.setAttribute(name, value)
	* 조회: request.getAttribute(name)
* 세션 관리 기능
	* request.getSession(create: true)

```
request.getMethod(); 		// GET            
request.getProtocol(); 		// HTTP/1. 1  
request.getScheme(); 		// http
request.getRequestURL();	// url    
request.getRequestURI();    // uri  
request.getQueryString();	// QueryString
request.getServerName(); 	// Host 헤더
request.getServerPort(); 	// Host 헤더
```


### HTTP 요청 메소드
* GET - 쿼리파라미터
	* /url?param1=val1&param2=val2
	* 메시지 바디 없이, URL의 쿼리 파라미터에 데이터를 포함해서 전달
* POST - HTML Form
	* content-type: application/x-www-form-urlencoded
	* 메시지 바디에 쿼리 파리미터 형식으로 전달 param1=val1&param2=val2
* HTTP message body에 데이터를 직접 담아서 요청
	* HTTP API에서 주로 사용, JSON, XML, TEXT



---

### JSON 요청
```
	private ObjectMapper objectMapper = new ObjectMapper();
	
	@Override
	protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		ServletInputStream inputStream = request.getInputStream();
		String messageBody = StreamUtils.copyToString(inputStream, StandardCharsets.UTF_8);
		HelloData helloData = objectMapper.readValue(messageBody, HelloData.class);
		helloData.getUsername();
		helloData.getAge();
	}
```	


### JSON 응답
```
	ObjectMapper objectMapper = new ObjectMapper();
	
	@Override
	protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		response.setContentType("application/json");
		response.setCharacterEncoding("utf-8");
		
		HelloData helloData = new HelloData();
		helloData.setUsername("kim");
		helloData.setAge(20);
		
		String result = objectMapper.writeValueAsString(helloData);
		response.getWriter().write(result);
	}
```
